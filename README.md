Needs a lot of refactoring that I probably won't do
Python 3.8.3